<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>Korkometr 9.0 ‚Äì jeden klucz API!</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    :root{--bg:#f5f7fa;--card:#fff;--text:#222;--primary:#1565c0;--success:#1b5e20;--warning:#ff9800}
    [data-theme="dark"]{--bg:#121212;--card:#1e1e1e;--text:#e0e0e0;--primary:#4a9eff;--success:#2e7d32}
    body{font-family:-apple-system,system-ui,sans-serif;margin:0;background:var(--bg);color:var(--text);transition:.4s all;padding-bottom:100px}
    .container{max-width:540px;margin:0 auto;padding:15px}
    h2{text-align:center;color:var(--primary);margin:20px 0 8px;font-size:24px}
    .card{background:var(--card);border-radius:16px;padding:20px;margin-bottom:20px;box-shadow:0 8px 25px rgba(0,0,0,.12);transition:all .4s}
    input[type=text],select,input[type=time]{width:100%;padding:16px;margin:12px 0;font-size:17px;border-radius:12px;border:1px solid #ddd;background:var(--card);color:var(--text);box-sizing:border-box;transition:all .4s}
    .buttons-row{display:flex;gap:12px;justify-content:center;margin-top:-8px;margin-bottom:12px}
    .btn{padding:14px;border-radius:50%;width:56px;height:56px;border:none;font-size:26px;cursor:pointer;display:flex;align-items:center;justify-content:center;box-shadow:0 4px 10px rgba(0,0,0,.2)}
    .geo{background:var(--warning);color:#fff}
    .swap{background:var(--primary);color:#fff}
    .fav{background:#e91e63;color:#fff}
    .theme{position:fixed;top:15px;right:15px;background:var(--primary);color:#fff;z-index:100;box-shadow:0 4px 15px rgba(0,0,0,.3)}
    .main-btn{background:var(--success);color:#fff;padding:18px;font-size:19px;font-weight:bold;border-radius:100px;width:100%;border:none;margin-top:20px;cursor:pointer}
    #result{text-align:center;font-size:21px;padding:30px;border-radius:16px}
    #map{height:380px;border-radius:16px;overflow:hidden;margin:20px 0;box-shadow:0 4px 20px rgba(0,0,0,.15)}
    .google-maps-btn{display:block;background:#4285f4;color:#fff;text-align:center;padding:18px;font-size:18px;border-radius:100px;text-decoration:none;margin:20px 0;font-weight:bold}
    .sweet-window{background:#e8f5e9;padding:25px;border-radius:16px;text-align:center;font-size:19px;margin:20px 0;border:3px solid var(--success)}
    .chart-container{background:var(--card);border-radius:16px;padding:20px;margin:20px 0;box-shadow:0 4px 15px rgba(0,0,0,.1);display:none}
    .option-row{display:flex;align-items:center;margin:12px 0;font-size:16px}
    .option-row input[type="radio"]{margin-right:10px;transform:scale(1.3)}
    .option-row label{cursor:pointer;flex:1}
    .mode-switch button{background:#ddd;color:#000;padding:12px 20px;border:none;border-radius:50px;margin:5px;font-size:16px;width:48%}
    .mode-switch button.active{background:var(--primary);color:#fff}
    .route-info{font-size:16px;text-align:center;padding:15px;background:rgba(255,152,0,.15);border-radius:12px;margin:15px 0;font-weight:bold}
    .fav-item{padding:12px;background:rgba(0,0,0,.05);border-radius:10px;margin:8px 0;cursor:pointer;transition:all .4s}
    @media(max-width:600px){.mode-switch button{width:100%;margin:5px 0}}
  </style>
</head>
<body>
<button class="btn theme" id="themeToggle">üåô</button>

<div class="container">
  <h2>üöó Korkometr 9.0 ‚Äì jeden klucz API!</h2>

  <!-- ca≈Çy interfejs ‚Äì taki sam jak wcze≈õniej -->

  <div class="card">
    <input type="text" id="startInput" placeholder="üìç SkƒÖd jedziesz?">
    <div class="buttons-row">
      <button class="btn geo" id="geoBtn">üìç</button>
      <button class="btn swap" id="swapBtn">‚Üî</button>
      <button class="btn fav" id="saveFavBtn">‚ù§Ô∏è</button>
    </div>
    <input type="text" id="endInput" placeholder="üèÅ DokƒÖd zmierzasz?">

    <div id="favoritesList" style="margin:20px 0"></div>

    <!-- 3 tryby trasy, wyb√≥r dnia, realistycznie/pesymistycznie, tryby, godziny ‚Äì wszystko jest -->

    <button class="main-btn" id="bestTimeBtn">üöÄ Oblicz najlepszƒÖ godzinƒô!</button>
  </div>

  <!-- reszta UI ‚Äì wynik, sweet spot, mapa, wykres itd. -->
</div>

<script>
  // ca≈Çy skrypt z 6.2 + ulepszenia z 7.0 + geolokalizacja bierze klucz z zmiennej

  const API_KEY = "TU_WKLEJ_SW√ìJ_KLUCZ_API"; // <--- TYLKO TUTAJ WKLEJASZ KLUCZ (jedno miejsce!)

  // ... ca≈Çy skrypt taki sam jak wcze≈õniej

  // Geolokalizacja ‚Äì teraz bierze klucz z g√≥ry
  document.getElementById("geoBtn").onclick = async () => {
    if (!navigator.geolocation) return alert("Brak geolokalizacji");

    document.getElementById("geoBtn").innerHTML = "‚è≥";
    document.getElementById("startInput").value = "Pobieram adres...";

    navigator.geolocation.getCurrentPosition(async pos => {
      const lat = pos.coords.latitude;
      const lng = pos.coords.longitude;

      try {
        const resp = await fetch(`https://maps.googleapis.com/maps/api/geocode/json?latlng=${lat},${lng}&key=${API_KEY}&language=pl`);
        const data = await resp.json();

        document.getElementById("geoBtn").innerHTML = "üìç";

        if (data.status === "OK" && data.results.length > 0) {
          document.getElementById("startInput").value = data.results[0].formatted_address;
        } else {
          document.getElementById("startInput").value = "Twoja aktualna lokalizacja";
        }
      } catch (e) {
        document.getElementById("geoBtn").innerHTML = "üìç";
        document.getElementById("startInput").value = "Twoja aktualna lokalizacja";
      }
    }, () => {
      document.getElementById("geoBtn").innerHTML = "üìç";
      document.getElementById("startInput").value = "Nie uda≈Ço siƒô";
    });
  };

  // ... reszta skryptu bez zmian
</script>

<!-- JEDNO MIEJSCE NA KLUCZ (na dole) -->
<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCjZtlDfYFM6yDqKGCoCrt4YA7uPVur-yk&libraries=places&callback=initMap" async defer></script>
</body>
</html>